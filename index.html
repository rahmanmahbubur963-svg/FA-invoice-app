<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Friends Association Invoice</title>

  <!-- PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- QR -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
</head>

<body style="font-family: Arial; padding:20px; text-align:center;">

<!-- 游댯 LOGO -->
<img src="https://i.imgur.com/6Xb6G7Q.png" width="120">
<h2>Friends Association</h2>

<hr>

<!-- Add Member -->
<input type="text" id="newMember" placeholder="New Member Name">
<button onclick="addMember()">Add Member</button>

<br><br>

<!-- Member Dropdown -->
<select id="memberSelect">
  <option value="">Select Member</option>
</select>

<br><br>

<!-- Month Dropdown -->
<select id="monthSelect">
  <option value="">Select Month</option>
</select>

<!-- Year Dropdown -->
<select id="yearSelect">
  <option value="">Select Year</option>
</select>

<br><br>

<input type="number" id="amount" placeholder="Amount">

<br><br>

<button onclick="generatePDF()">Download PDF Invoice</button>

<script>

let members = [];

/* 游릭 Add Member */
function addMember() {
  let name = document.getElementById("newMember").value;
  if(name !== "") {
    members.push(name);
    let option = document.createElement("option");
    option.text = name;
    option.value = name;
    document.getElementById("memberSelect").add(option);
    document.getElementById("newMember").value = "";
  }
}

/* 游릭 Load Month */
const months = [
"January","February","March","April","May","June",
"July","August","September","October","November","December"
];

let monthSelect = document.getElementById("monthSelect");
months.forEach(m => {
  let option = document.createElement("option");
  option.text = m;
  option.value = m;
  monthSelect.add(option);
});

/* 游릭 Load Year (2000 - 2045 auto extendable) */
let yearSelect = document.getElementById("yearSelect");
let currentYear = new Date().getFullYear();

for(let y = 2000; y <= currentYear + 20; y++) {
  let option = document.createElement("option");
  option.text = y;
  option.value = y;
  yearSelect.add(option);
}

/* 游릭 Generate PDF */
async function generatePDF() {

  const { jsPDF } = window.jspdf;

  let member = document.getElementById("memberSelect").value;
  let amount = document.getElementById("amount").value;
  let month = document.getElementById("monthSelect").value;
  let year = document.getElementById("yearSelect").value;

  if(member === "" || amount === "" || month === "" || year === "") {
    alert("All fields required");
    return;
  }

  let doc = new jsPDF();

  let invoiceNo = "FA-" + Math.floor(Math.random()*100000);

  let invoiceText = `
Friends Association
Invoice No: ${invoiceNo}

Member: ${member}
Month: ${month}
Year: ${year}
Amount: ${amount} Tk
Date: ${new Date().toLocaleDateString()}
`;

  doc.text(invoiceText, 20, 40);

  /* QR Code */
  QRCode.toDataURL(invoiceText, function (err, url) {
      doc.addImage(url, 'PNG', 20, 90, 50, 50);
      doc.save("invoice.pdf");
  });
}

</script>

</body>
</html>
